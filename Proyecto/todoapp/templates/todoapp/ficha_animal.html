<!DOCTYPE html>
<html>
<head>
    <title>Ficha Animal</title>
    <meta charset="UTF-8">
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static '/todoapp/desing_style.css' %}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const speciesToBreeds = {
                'Perro': ['Labrador Retriever', 'Golden Retriever', 'Pastor Alemán', 'Bulldog Francés', 'Bulldog Inglés', 'Chihuahua', 'Boxer', 'Dálmata', 'Poodle', 'Pug', 'Quiltro'],
                'Gato': ['Siamés', 'Persa', 'Maine Coon', 'Bengalí', 'Ragdoll', 'British Shorthair', 'Sphynx', 'Abisinio', 'Birmano', 'American Shorthair', 'Gato mestizo'],
                'Ave': ['Canario', 'Periquito', 'Cacatúa', 'Cotorra', 'Periquito Australiano', 'Diamante Mandarín', 'Agapornis', 'Calafate'],
                'Reptil': ['Gecko leopardo', 'Iguana verde', 'Tortuga de orejas rojas', 'Dragón barbudo', 'Tortuga rusa', 'Python real', 'Boa constrictor', 'Gecko crestado', 'Tortuga mediterránea', 'Tortuga de tierra'],
                'Roedor': ['Cobaya', 'Hámster', 'Rata doméstica', 'Conejo', 'Chinche degú', 'Jerbo', 'Cuyo', 'Ratón doméstico', 'Criceto', 'Cuyo de pelo largo']
            };

            const speciesSelect = document.getElementById('especie_mascota');
            const breedSelect = document.getElementById('raza_mascota');

            speciesSelect.addEventListener('change', function() {
                const selectedSpecies = speciesSelect.value;
                const breeds = speciesToBreeds[selectedSpecies] || [];
                
                breedSelect.innerHTML = '<option value="" disabled selected>Seleccionar</option>';
                breeds.forEach(function(breed) {
                    const option = document.createElement('option');
                    option.value = breed;
                    option.textContent = breed;
                    breedSelect.appendChild(option);
                });

                breedSelect.disabled = breeds.length === 0;
            });
        });
        document.addEventListener('DOMContentLoaded', function() {
            var regionesToComunas = JSON.parse(['{{ COMUNAS|escapejs }}']);
            const regionSelect = document.getElementById('region_extravio');
            const comunaSelect = document.getElementById('comuna_extravio');
            regionSelect.addEventListener('change', function() {
                const selectedRegion = regionSelect.value;
                const comuna_reg = regionesToComunas[selectedRegion] || [];
                comunaSelect.innerHTML = '<option value="" disabled selected>Seleccionar</option>';
                comuna_reg.forEach(function(comuna_reg) {
                    console.log(comuna_reg)
                    const option2 = document.createElement('option');
                    option2.value = comuna_reg;
                    option2.textContent = comuna_reg;
                    comunaSelect.appendChild(option2);
                });
                comunaSelect.disabled = comuna_reg.length === 0;
            });
        });

    </script>
</head>
<body>
    <style>
        /* Usado en perfil_usuario.html para el boton de "Cerrar Sesión" */
        .custom-button-logout {
            display: block;                
            width: 200px !important;       
            margin: 0 auto !important;     
            padding: 10px 20px !important; 
            font-size: 20px !important;    
            background-color: #007bff !important;  
            color: #fff !important;        
            border: none !important;       
            border-radius: 4px !important; 
            border-color: #007bff !important;
            text-align: center !important; 
        }
        /* Usado en menu.html para la navbar */
        .custom-dropdown-toggle {
            background-color: gray !important;
            color: white !important;
            border: none !important;
        }
        /* Modifica el color de fondo de la navbar */
        .navbar-custom {
            background-color:  rgba(174, 200, 180, 1);
            opacity: 1;
        }
    </style>
    <!--NavBar tiene: Logo|Busca Patitas(a la izquierda) y 2 botones(a la derecha)-->
    <nav class="navbar navbar-light navbar-custom">
        <a class="navbar-brand" href="#">
            <img src="{% static 'todoapp/img/logo.jpg' %}" width="30" height="30" class="d-inline-block align-top" alt="">    
            Busca Patitas
        </a>
        
        <!-- Botones Home y Perfil-->
        <form class="form-inline">
            <!--Boton Home: Redirecciona a la pagina principal-->
            <a href="http://127.0.0.1:8000/" class="btn btn-primary mr-2">Home</a>
            <!--Boton Perfil: Permite redireccionar a "Iniciar Sesion" o "Registrarse"-->
            {% if user.is_authenticated %}
                <!-- Menú desplegable para usuarios autenticados: Permite acceder a "Ver mi perfil" y "Cerrar Sesion" -->
                <div class="dropdown">
                    <button class="btn custom-dropdown-toggle dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Perfil
                    </button>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item" href="{% url 'perfil_usuario' %}">Ver mi perfil</a>
                        <a class="dropdown-item" href="{% url 'logout' %}">Cerrar Sesión</a>
                    </div>
                </div>                
            {% else %}
                <!-- Menú desplegable para usuarios no autenticados: Permite acceder a Iniciar Sesión y Registrarse -->
                <div class="dropdown">
                    <button class="btn custom-dropdown-toggle dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Perfil
                    </button>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item" href="{% url 'register_user' %}">Registrarse</a>
                        <a class="dropdown-item" href="{% url 'login' %}">Iniciar Sesión</a>
                    </div>
                </div>
            {% endif %}
        </form>
    </nav>
    <!-- Títulos principales, fondo verde, Título a la izquierda y un botón a la derecha -->
    <div class="background_title1">
        <!-- TÍTULO A LA IZQUIERDA -->
        <h3 class="title">
            Nueva Ficha Mascota
        </h3>
    </div>

    <!DOCTYPE html>
<html>
<head>
    <title>Ficha Animal</title>
    <meta charset="UTF-8">
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'todoapp/desing_style.css' %}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-Jc8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <style>
        .required-field::after {
            content: ' *';
            color: red;
        }
    </style>
    <div class="container mt-4">
        <div class="card p-4 bg-light">
            <form action="/fichaAnimal/" method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <!-- nombre -->
                <div class="div_lr_input d-flex justify-content-between mt-2">
                    <label for="nombre_mascota" class="lr_label required-field">Nombre de la Mascota:</label>
                    <input type="text" class="form-control lr_input" id="nombre_mascota" name="nombreAnimal" required>
                </div>
                <!-- fecha y hora -->
                <div class="div_lr_input d-flex justify-content-between mt-2">
                    <label for="fecha_extravio" class="lr_label required-field">Fecha de extravío:</label>
                    <input type="date" class="form-control lr_input" id="fecha_extravio" name="fechaExtravio" required>
                </div>
                <div class="div_lr_input d-flex justify-content-between mt-2">
                    <label for="hora_extravio" class="lr_label required-field">Hora de extravío:</label>
                    <input type="time" class="form-control lr_input" id="hora_extravio" name="horaExtravio" required>
                </div>
                <!-- ubicacion -->
                <div class = "div_lr_input d-flex justify-content-between mt-2">
                    <label for="region_extravio" class="lr_label required-field">Region extravio</label>
                    <select class="form-control lr_input" id="region_extravio" name="RegionExtravio" required>
                        <option value="" disabled selected> Seleccionar </option>
                            {% for region in REGIONES%}
                            <option value="{{region}}">{{region}}</option>
                            {%endfor%}
                    </select>
                </div>
                <div class = "div_lr_input d-flex justify-content-between mt-2">
                    <label for="comuna_extravio" class="lr_label required-field">Comuna extravio</label>
                    <select class="form-control lr_input" id="comuna_extravio" name="ComunaExtravio" required>
                        <option value="" disabled selected> Seleccionar </option>
                    </select>
                </div>


                <!-- especie -->
                <div class="div_lr_input d-flex justify-content-between mt-2">
                    <label for="especie_mascota" class="lr_label required-field">Especie:</label>
                    <select class="form-control lr_input" id="especie_mascota" name="especie" required>
                        <option value="" disabled selected>Seleccionar</option>
                        <option value="Perro">Perro</option>
                        <option value="Gato">Gato</option>
                        <option value="Ave">Ave</option>
                        <option value="Reptil">Reptil</option>
                        <option value="Roedor">Roedor</option>
                    </select>
                </div>
                <!-- color -->
                <div class="div_lr_input d-flex justify-content-between mt-2">
                    <label for="color_mascota" class="lr_label required-field">Color:</label>
                    <select class="form-control lr_input" id="color_mascota" name="color" required>
                        <option value="" disabled selected>Seleccionar</option>
                        <option value="Negro">Negro</option>
                        <option value="Blanco">Blanco</option>
                        <option value="Marrón">Marrón</option>
                        <option value="Gris">Gris</option>
                        <option value="Atigrado">Atigrado</option>
                        <option value="Beige">Beige</option>
                        <option value="Naranja">Naranja</option>
                        <option value="Manchado">Manchado</option>
                    </select>
                </div>
                <!-- raza -->
                <div class="div_lr_input d-flex justify-content-between mt-2">
                    <label for="raza_mascota" class="lr_label required-field">Raza:</label>
                    <select class="form-control lr_input" id="raza_mascota" name="raza" required disabled>
                        <option value="" disabled selected>Seleccionar</option>
                    </select>
                </div>
                <div class="div_lr_input d-flex justify-content-between mt-2">
                    <label for="tiene_chip" class="lr_label required-field">¿Tiene chip?:</label>
                    <select class="form-control lr_input" id="tiene_chip" name="tieneChip" required>
                        <option value="" disabled selected>Seleccionar</option>
                        <option value="si">Sí</option>
                        <option value="no">No</option>
                    </select>
                </div>
                <div class="div_lr_input d-flex justify-content-between mt-2">
                    <label for="descripcion_mascota" class="lr_label required-field">Descripción:</label>
                    <textarea class="form-control lr_input" id="descripcion_mascota" name="descripcion" rows="3" required></textarea>
                </div>
                <div class="div_lr_input d-flex justify-content-between mt-2">
                    <label for="fotos_mascota" class="lr_label required-field">Fotos de la mascota:</label>
                    <input type="file" class="form-control lr_input" id="fotos_mascota" name="fotos" multiple required accept="image/png, image/jpeg">
                </div>
                <div class="d-flex justify-content-center mt-3">
                    <input type="submit" value="Publicar" class="btn btn-primary">
                </div>
            </form>
        </div>
    </div>
</body>
</html>
